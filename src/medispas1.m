function medispas1(sta) % autogenerated function wrapper
    %  This is subroutine " medispas1.m". A as(t) value is calculated for
    %  a given mean depth  curve and displayed in the plot.
    %  Overlapping mean depth windows are avoided
    %  Operates on catalogue ZG.newcat                          A.Allmann
    % turned into function by Celso G Reyes 2017
    
    ZG=ZmapGlobal.Data; % used by get_zmap_globals
    
    report_this_filefun(mfilename('fullpath'));
    
    %
    % calculate mean and z value
    %
    ncu = length(xt2);    %number of all mean depth windows
    af = iwln/step;     %to avoid resampling because of overlapping windows
    m = 0;            %counter of independent mean depth windows without iwl
    as = [];
    xt3 = [];
    
    % calculation of the as values and attached times
    %
    if sta == 'ast'
        for i = 1+iwl*af:af:ind-iwl*af
            mean1 = mean(meand(1:af:i));
            mean2 = mean(meand(i:af:ncu));
            var1 = cov(meand(1:af:i));
            var2 = cov(meand(i:af:ncu));
            m = m+1;
            as(m) = (mean1 - mean2)/sqrt(var1/(1+fix(i*(step/iwln)))+...
                var2/fix((ncu-i)*(step/iwln)));
            xt3(m) = xt2(i);
        end     % for i
    end     % if sta
    
    if sta == 'lta'
        for i = 1+iwl*af:af:ind-iwl*af
            mean1 = mean(meand(1:af:ncu));
            mean2 = mean(meand(i:af:i+iwl));
            var1 = cov(meand(1:af:ncu));
            var2 = cov(meand(i:af:i+iwl));
            m = m+1;
            as(m) = (mean1 - mean2)/sqrt(var1/length(meand(1:af:ncu)) +...
                var2/length(i:af:i+iwln));
            xt3(m) = xt2(i);
        end     % for i
    end % if sta == lta
    
    
    %
    %  Plot the as(t)
    %
    
    try
        delete(p5)
        delete(ax1)
    catch ME
        error_handler(ME, @do_nothing);
    end
    figure
    orient tall
    rect = [0.15, 0.10, 0.65, 0.30];
    axes('position',rect)
    p5 = gca;
    
    plot(xt3,as,'r')
    
    
    
    xlabel('Time  [years]')
    ylabel('Mean Depth (km)')
    
    stri = ['Mean depth and z-value of ' file1];
    title(stri)
    grid
    
end
