classdef FancyColors
    % FANCYCOLORS provides additional color choices for use with MATLAB.
    % colors may be specifed by name, RGB [0..1] vector, or HEX
    %
    % example usage:
    %    % create a line of a defined  color, by name
    %    line(rand(5,1),rand(5,1),'Color', FancyColors.rgb('orange red'))
    %
    %    % create a button that displays a random color from the list
    %     s = sprintf('Change to a random color');
    %     new_s = @() FancyColors.autocolorize(sprintf('I am now [%s]',FancyColors.name(rand(1,3))));
    %     uicontrol('Style','pushbutton','String', s ,'TooltipString','Change to new color',...
    %         'Callback', @(s,~)set(s, 'String', new_s()), 'Position',[20, 20, 180, 20]);
    %
    %    % run the example
    %    FancyColors.example;
    %
    % Created By Celso G. Reyes
    
    % color values modified from https://www.rapidtables.com/web/color/RGB_Color.html
    % or  http://chir.ag/projects/name-that-color/
   
    properties(Constant)
        % lookup-list of color names, RGB decimal values, and hexidecimal strings.
        colors = {... name, 0-1 decimal, hex
            'maroon', [0.50 0.00 0.00], '800000';...
            'dark red', [0.55 0.00 0.00], '8C0000';...
            'brown', [0.65 0.16 0.16], 'A62929';...
            'firebrick', [0.70 0.13 0.13], 'B32121';...
            'crimson', [0.86 0.08 0.24], 'DB143D';...
            'red', [1.00 0.00 0.00], 'FF0000';...
            'tomato', [1.00 0.39 0.28], 'FF6347';...
            'coral', [1.00 0.50 0.31], 'FF804F';...
            'indian red', [0.80 0.36 0.36], 'CC5C5C';...
            'light coral', [0.94 0.50 0.50], 'F08080';...
            'dark salmon', [0.91 0.59 0.48], 'E8967A';...
            'salmon', [0.98 0.50 0.45], 'FA8073';...
            'light salmon', [1.00 0.63 0.48], 'FFA17A';...
            'orange red', [1.00 0.27 0.00], 'FF4500';...
            'dark orange', [1.00 0.55 0.00], 'FF8C00';...
            'orange', [1.00 0.65 0.00], 'FFA600';...
            'gold', [1.00 0.84 0.00], 'FFD600';...
            'dark golden rod', [0.72 0.53 0.04], 'B8870A';...
            'golden rod', [0.85 0.65 0.13], 'D9A621';...
            'pale golden rod', [0.93 0.91 0.67], 'EDE8AB';...
            'dark khaki', [0.74 0.72 0.42], 'BDB86B';...
            'khaki', [0.94 0.90 0.55], 'F0E68C';...
            'olive', [0.50 0.50 0.00], '808000';...
            'yellow', [1.00 1.00 0.00], 'FFFF00';...
            'yellow green', [0.60 0.80 0.20], '99CC33';...
            'dark olive green', [0.33 0.42 0.18], '546B2E';...
            'olive drab', [0.42 0.56 0.14], '6B8F24';...
            'lawn green', [0.49 0.99 0.00], '7DFC00';...
            'chart reuse', [0.50 1.00 0.00], '80FF00';...
            'green yellow', [0.68 1.00 0.18], 'ADFF2E';...
            'dark green', [0.00 0.39 0.00], '006300';...
            'green', [0.00 0.50 0.00], '008000';...
            'forest green', [0.13 0.55 0.13], '218C21';...
            'lime', [0.00 1.00 0.00], '00FF00';...
            'lime green', [0.20 0.80 0.20], '33CC33';...
            'light green', [0.56 0.93 0.56], '8FED8F';...
            'pale green', [0.60 0.98 0.60], '99FA99';...
            'dark sea green', [0.56 0.74 0.56], '8FBD8F';...
            'medium spring green', [0.00 0.98 0.60], '00FA99';...
            'spring green', [0.00 1.00 0.50], '00FF80';...
            'sea green', [0.18 0.55 0.34], '2E8C57';...
            'medium aqua marine', [0.40 0.80 0.67], '66CCAB';...
            'medium sea green', [0.24 0.70 0.44], '3DB370';...
            'light sea green', [0.13 0.70 0.67], '21B3AB';...
            'dark slate gray', [0.18 0.31 0.31], '2E4F4F';...
            'teal', [0.00 0.50 0.50], '008080';...
            'dark cyan', [0.00 0.55 0.55], '008C8C';...
            'cyan', [0.00 1.00 1.00], '00FFFF';...
            'light cyan', [0.88 1.00 1.00], 'E0FFFF';...
            'dark turquoise', [0.00 0.81 0.82], '00CFD1';...
            'turquoise', [0.25 0.88 0.82], '40E0D1';...
            'medium turquoise', [0.28 0.82 0.80], '47D1CC';...
            'pale turquoise', [0.69 0.93 0.93], 'B0EDED';...
            'aqua marine', [0.50 1.00 0.83], '80FFD4';...
            'powder blue', [0.69 0.88 0.90], 'B0E0E6';...
            'cadet blue', [0.37 0.62 0.63], '5E9EA1';...
            'steel blue', [0.27 0.51 0.71], '4582B5';...
            'corn flower blue', [0.39 0.58 0.93], '6394ED';...
            'deep sky blue', [0.00 0.75 1.00], '00BFFF';...
            'dodger blue', [0.12 0.56 1.00], '1F8FFF';...
            'light blue', [0.68 0.85 0.90], 'ADD9E6';...
            'sky blue', [0.53 0.81 0.92], '87CFEB';...
            'light sky blue', [0.53 0.81 0.98], '87CFFA';...
            'midnight blue', [0.10 0.10 0.44], '1A1A70';...
            'navy', [0.00 0.00 0.50], '000080';...
            'dark blue', [0.00 0.00 0.55], '00008C';...
            'medium blue', [0.00 0.00 0.80], '0000CC';...
            'blue', [0.00 0.00 1.00], '0000FF';...
            'royal blue', [0.25 0.41 0.88], '4069E0';...
            'blue violet', [0.54 0.17 0.89], '8A2BE3';...
            'indigo', [0.29 0.00 0.51], '4A0082';...
            'dark slate blue', [0.28 0.24 0.55], '473D8C';...
            'slate blue', [0.42 0.35 0.80], '6B59CC';...
            'medium slate blue', [0.48 0.41 0.93], '7A69ED';...
            'medium purple', [0.58 0.44 0.86], '9470DB';...
            'dark magenta', [0.55 0.00 0.55], '8C008C';...
            'dark violet', [0.58 0.00 0.83], '9400D4';...
            'dark orchid', [0.60 0.20 0.80], '9933CC';...
            'medium orchid', [0.73 0.33 0.83], 'BA54D4';...
            'purple', [0.50 0.00 0.50], '800080';...
            'thistle', [0.85 0.75 0.85], 'D9BFD9';...
            'plum', [0.87 0.63 0.87], 'DEA1DE';...
            'violet', [0.93 0.51 0.93], 'ED82ED';...
            'magenta', [1.00 0.00 1.00], 'FF00FF';...
            'orchid', [0.85 0.44 0.84], 'D970D6';...
            'medium violet red', [0.78 0.08 0.52], 'C71485';...
            'pale violet red', [0.86 0.44 0.58], 'DB7094';...
            'deep pink', [1.00 0.08 0.58], 'FF1494';...
            'hot pink', [1.00 0.41 0.71], 'FF69B5';...
            'light pink', [1.00 0.71 0.76], 'FFB5C2';...
            'pink', [1.00 0.75 0.80], 'FFBFCC';...
            'antique white', [0.98 0.92 0.84], 'FAEBD6';...
            'beige', [0.96 0.96 0.86], 'F5F5DB';...
            'bisque', [1.00 0.89 0.77], 'FFE3C4';...
            'blanched almond', [1.00 0.92 0.80], 'FFEBCC';...
            'wheat', [0.96 0.87 0.70], 'F5DEB3';...
            'corn silk', [1.00 0.97 0.86], 'FFF7DB';...
            'lemon chiffon', [1.00 0.98 0.80], 'FFFACC';...
            'light golden rod yellow', [0.98 0.98 0.82], 'FAFAD1';...
            'light yellow', [1.00 1.00 0.88], 'FFFFE0';...
            'saddle brown', [0.55 0.27 0.07], '8C4512';...
            'sienna', [0.63 0.32 0.18], 'A1522E';...
            'chocolate', [0.82 0.41 0.12], 'D1691F';...
            'peru', [0.80 0.52 0.25], 'CC8540';...
            'sandy brown', [0.96 0.64 0.38], 'F5A361';...
            'burly wood', [0.87 0.72 0.53], 'DEB887';...
            'tan', [0.82 0.71 0.55], 'D1B58C';...
            'rosy brown', [0.74 0.56 0.56], 'BD8F8F';...
            'moccasin', [1.00 0.89 0.71], 'FFE3B5';...
            'navajo white', [1.00 0.87 0.68], 'FFDEAD';...
            'peach puff', [1.00 0.85 0.73], 'FFD9BA';...
            'misty rose', [1.00 0.89 0.88], 'FFE3E0';...
            'lavender blush', [1.00 0.94 0.96], 'FFF0F5';...
            'linen', [0.98 0.94 0.90], 'FAF0E6';...
            'old lace', [0.99 0.96 0.90], 'FCF5E6';...
            'papaya whip', [1.00 0.94 0.84], 'FFF0D6';...
            'sea shell', [1.00 0.96 0.93], 'FFF5ED';...
            'mint cream', [0.96 1.00 0.98], 'F5FFFA';...
            'slate gray', [0.44 0.50 0.56], '70808F';...
            'light slate gray', [0.47 0.53 0.60], '788799';...
            'light steel blue', [0.69 0.77 0.87], 'B0C4DE';...
            'lavender', [0.90 0.90 0.98], 'E6E6FA';...
            'floral white', [1.00 0.98 0.94], 'FFFAF0';...
            'alice blue', [0.94 0.97 1.00], 'F0F7FF';...
            'ghost white', [0.97 0.97 1.00], 'F7F7FF';...
            'honeydew', [0.94 1.00 0.94], 'F0FFF0';...
            'ivory', [1.00 1.00 0.94], 'FFFFF0';...
            'azure', [0.94 1.00 1.00], 'F0FFFF';...
            'snow', [1.00 0.98 0.98], 'FFFAFA';...
            'black', [0.00 0.00 0.00], '000';...
            'dim gray', [0.41 0.41 0.41], '696969';...
            'gray', [0.50 0.50 0.50], '808080';...
            'dark gray', [0.66 0.66 0.66], 'A8A8A8';...
            'silver', [0.75 0.75 0.75], 'BFBFBF';...
            'light gray', [0.83 0.83 0.83], 'D4D4D4';...
            'gainsboro', [0.86 0.86 0.86], 'DBDBDB';...
            'white smoke', [0.96 0.96 0.96], 'F5F5F5';...
            'white', [1.00 1.00 1.00], 'FFFFFF';...
            ... default matlab colors looked up at http://chir.ag/projects/name-that-color/
            'tamarillo',[0.635  0.078 0.184], 'A2142F';...
            'picton blue',[0.3010    0.7450    0.9330],'4DBEEE';...
            'sushi', [0.4660    0.6740    0.1880], '77AC30';...
            'vivid violet',[0.4940    0.1840    0.5560], '7E2F8E';...
            'fuel yellow', [0.9290    0.6940    0.1250],'EDB120';...
            'orange roughy',[0.8500    0.3250    0.0980],'D95319';...
            'lochmara',[0    0.4470    0.7410],'0072BD'
            }
    end
    
    methods(Static, Access=private)
        function idx = name2idx(name)
            % NAME2IDX return the index into the color matrix corresponding to a name
            if ischar(name) || isstring(name)
                idx=find(strcmpi(name,FancyColors.colors(:,1)));
            else
                idx = [];
            end
        end
        
        function idx = rgb2idx(rgb)
            % RGB2IDX return the index into the color matrix corresponding to a decimal RGB vector
            % this returns the closest matching value.
            if  isnumeric(rgb) && numel(rgb)==3
                % look up closest value from decimal RGB
                vals=cell2mat(FancyColors.colors(:,2));
                [~,idx]=min((vals(:,1)-rgb(1)).^2 + (vals(:,2)-rgb(2)).^2 + (vals(:,3)-rgb(3)).^2);
            else
                idx=[];
            end
        end
        
        function idx = hex2idx(hexval)
           % HEX2IDX return the index into the color matrix corresponding to a hexidecimal RGB value
            if ischar(hexval) && length(hexval)==6
                idx=find(strcmpi(FancyColors.colors(:,3),hexval));
            else
                idx=[];
            end
        end
    end
    
    methods(Static)
        
        function n=name(val)
            % NAME translates an RGB decimal value or hex string to a color name
            if ischar(val)
                n=FancyColors.colors{FancyColors.hex2idx(val),1};
            else
                n=FancyColors.colors{FancyColors.rgb2idx(val),1};
            end
        end
        
        function h=hex(val)
            % HEX translates a color name or RGB decimal value to a hex string
            if ischar(val)
                h=FancyColors.colors{FancyColors.name2idx(val),3};
            else
                h=FancyColors.colors{FancyColors.rgb2idx(val),3};
            end
        end
        
        function d=rgb(val)
            % RGB translate from a color name or hex value into the RGB decimal value
            % d= RGB( name )
            % d = RGB( hexstring )
            if length(val)==6&& all(ismember(val,'ABCDEF0123456789'))
                d=FancyColors.colors{FancyColors.hex2idx(val),2};
            else
                d=FancyColors.colors{FancyColors.name2idx(val),2};
            end
        end
        
        function s=colorize(s,color, varargin)
            %COLORIZE adds html to text to render it in color in several 
            % S = COLORIZE (S , COLOR) will add html tags to the string S, changing it
            % the the requested COLOR.  COLOR can be specified as a matlab RGB designation, or
            % as a Hex string 'RRGGBB', or as a color name.
            %
            % By default, this function  wraps the string in a <font> tag to define the color.
            % it also adds <html> to the front, so that MATLAB knows to properl interpet it.
            %
            % S = COLORIZE ( ... , 'nohtml') do not add the "<html>" tag to the beginning. Useful
            % when this string will be inserted into another one.  
            %
            % NOTE: this works for most uicontrol items, including pushbutton, radiobutton, 
            %       togglebutton, checkbox, listbox, popupmenu
            %
            % It also works inside tooltips.
            htmltag= '<html>';
            
            % don't duplicate an existing <html> tag.
            if startsWith(s,htmltag)
                htmltag='';
            end
            
            for z=1:numel(varargin)
                if exist('opt','var')
                    switch opt
                        case 'nohtml'
                            htmltag = '';
                    end
                end
            end
            val_is_hex = length(color)==6&& all(ismember(color,'ABCDEF0123456789'));
            if val_is_hex
                s=[htmltag, '<font color="#',color,'">',s,'</font>'];
            else
                s=[htmltag, '<font color="#',FancyColors.hex(color),'">',s,'</font>'];
            end
        end
        
        function s=autocolorize(s)
            % AUTOCOLORIZE automatically adds color to the color name in string. 
            % string must either be the color name, or the color name must be surrounded by []
            if any(s=='[')
                st=find(s=='[') + 1;
                ed=find(s==']') - 1;
            else
                % entire s should be a string
                st=1;
                ed=length(s);
            end
            was_colored=false;
            for n=numel(st):-1:1
                cn=s(st(n) : ed(n) );
                hx= FancyColors.hex(cn);
                if ~isempty(hx)
                    cn=FancyColors.colorize(cn,cn,'nohtml');
                    was_colored=true;
                    s=[s(1:st(n)-1) , cn , s(ed(n)+1 : end)];
                end
            end
            if was_colored
                s=['<html>', s];
            end
            
        end
        
        function test(idx)
            % TEST test to make sure FANCYCOLORS works.
            if ~exist('idx','var')
                nColors = size(FancyColors.colors,1);
                idx= randi(nColors);
            end
            fprintf('testing %d , [''%s''], (%0.2f %0.2f %0.2f), #%s\n',idx,FancyColors.colors{idx,:});
            myname=FancyColors.colors{idx,1};
            mydec =FancyColors.colors{idx,2};
            myhex = FancyColors.colors{idx,3};
            
            assert(FancyColors.rgb2idx(mydec)==idx);
            assert(FancyColors.name2idx(myname)==idx);
            assert(FancyColors.hex2idx(myhex)==idx);
            
            assert(strcmp(myname,FancyColors.name(mydec)));
            assert(strcmp(myname,FancyColors.name(myhex)));
            assert(strcmp(myhex,FancyColors.hex(mydec)));
            assert(strcmp(myhex,FancyColors.hex(myname)));
            assert(isequal(mydec,FancyColors.rgb(myname)));
            assert(isequal(mydec,FancyColors.rgb(myhex)));
            
            txt = 'test';
            colorized = FancyColors.colorize(txt,'plum');
            assert(strcmp(colorized,'<html><font color="#DEA1DE">test</font>'));
            
            txt = 'test [plum] [RED]';
            colorized = FancyColors.autocolorize(txt);
            expected = '<html>test [<font color="#DEA1DE">plum</font>] [<font color="#FF0000">RED</font>]';
            assert(strcmp(colorized, expected));
        end
       
        function example()
            % add a button that changes color
            f=figure('Name','FancyColor example','Units','pixels','MenuBar','none');
            f.Position([3 4]) = [430 300];
            s = sprintf('Change to a random color');
            pb = uicontrol(f,'Style','pushbutton','String', s ,'TooltipString','Change to new color',...
                'Callback', @add_to_list, 'Units','pixels', 'Position',[20, 10, 250, 20]);
            
            lb  = uicontrol(f,'Style','listbox','String',{'<html><b><code>hexval [ red green blue] - name'},...
                'Units','pixels', 'Position',[20, 35, 400, 260],'Callback',@change_button);
            
            function add_to_list(s,~)
                color = FancyColors.name(rand(1,3));
                new_s = FancyColors.autocolorize(sprintf('I am now [%s]',color));
                s.String=new_s;
                this_rgb = FancyColors.rgb(color);
                
                lb.String(end+1)={sprintf('<html><code>#%6s [%0.2f %0.2f %0.2f] - %s',...
                    FancyColors.colorize(FancyColors.hex(color),color,'nohtml'), ...
                    this_rgb(1), this_rgb(2), this_rgb(3), ...
                    color)};
                lb.Value=numel(lb.String);
            end
            function change_button(s,~)
                if s.Value > 1
                    active = s.String{s.Value};
                    color = strip(active(find(active=='-')+1 : end));
                    set(pb, 'string',  FancyColors.autocolorize(sprintf('I am now [%s]',color)));
                end
            end
            
        end
    end
end